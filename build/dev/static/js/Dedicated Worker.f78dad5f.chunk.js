(()=>{"use strict";var e={524:(e,t,o)=>{o.d(t,{m7:()=>r});var n=o(6603);class r extends n.R{constructor(e){super("component",e),this.component=void 0,this.value=void 0,this.desc=void 0,this.viewButtons=void 0,this.backlight=void 0,this.aligin=void 0,this.component="table",this.value="",this.desc="",this.backlight=!0,this.viewButtons=!1,this.aligin="left",Object.setPrototypeOf(this,null)}}},6603:(e,t,o)=>{o.d(t,{R:()=>r});var n=o(1990);class r{constructor(e,t){this.id=void 0,this.type=void 0;const o=t||n._.instatnceIdGenerator;if(!o)throw new Error("IdGenerator is not defined");this.id=o.generateId(),this.type=e,Object.setPrototypeOf(this,null)}}},8594:(e,t,o)=>{o.d(t,{$:()=>n});class n{constructor(e,t){this.tag_name=void 0,this.color=void 0,this.tag_name=e,this.color=t,Object.setPrototypeOf(this,null)}}},1990:(e,t,o)=>{o.d(t,{R:()=>r,_:()=>a});var n=o(8965);class r{constructor(e){this._cache=new Set,this._cache=e}generateId(){const e=()=>{let e="";for(let t=0;t<16;t++)e+=r._charMap.charAt(Math.floor(Math.random()*r._charMap.length));return e};let t;do{t=e()}while(this._cache.has(t));return this._cache.add(t),console.log("idGenerator: add -> ".concat(t)),t}deleteId(e){this._cache.has(e)&&(this._cache.delete(e),console.log("idGenerator: delete -> ".concat(e)))}getIdsArray(){return Array.from(this._cache)}}r._charMap="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";const a=new Proxy({instatnceIdGenerator:void 0},{set(e,t,o,r){if((0,n.I)())throw console.error("set savedIdGenerator.instatnceIdGenerator can not be used in worker scope"),new Error("set savedIdGenerator.instatnceIdGenerator can not be used in worker scope");return"instatnceIdGenerator"===t&&(window.dispatchEvent(new CustomEvent("appIdGeneratorNewInstance")),console.group("savedIdGenerator: updated"),console.log(o),console.groupEnd()),Reflect.set(e,t,o,r)}})},8965:(e,t,o)=>{function n(){return"object"===typeof self&&"[object DedicatedWorkerGlobalScope]"===self.toString()}o.d(t,{I:()=>n})},8954:(e,t,o)=>{function n(e){return"object"===typeof e&&("type"in e&&"note"===e.type)}function r(e){return"object"===typeof e&&("type"in e&&"folder"===e.type)}function a(e){return"object"===typeof e&&("type"in e&&"component"===e.type)}function i(e){return"object"===typeof e&&("argument_names"in e&&("argument_values"in e&&("func_data"in e&&("type"in e&&(!("type"in e)||"function executor"===e.type)&&(!!Array.isArray(e.argument_names)&&!!Array.isArray(e.argument_values))))))}function d(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"delete by id"===e.type)&&(!(!("rootNode"in e)||"rootNode"in e&&!r(e.rootNode))&&("target_id"in e&&(!("target_id"in e)||"string"===typeof e.target_id)&&!(!("savedIdGenerator"in e)||"savedIdGenerator"in e&&!Array.isArray(e.savedIdGenerator)))))}function s(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"delete component in note"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("componentID"in e&&(!("componentID"in e)||"string"===typeof e.componentID)&&!(!("savedIdGenerator"in e)||"savedIdGenerator"in e&&!Array.isArray(e.savedIdGenerator)))))}function l(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"clone filtred tree"===e.type)&&(!(!("orig_obj"in e)||"orig_obj"in e&&!r(e.orig_obj))&&"filtres"in e))}function c(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"update node value"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("noteId"in e&&(!("noteId"in e)||"string"===typeof e.noteId)&&("componentId"in e&&(!("componentId"in e)||"string"===typeof e.componentId)&&("newValue"in e&&(!("newValue"in e)||"string"===typeof e.newValue))))))}function u(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"update note components order"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("noteId"in e&&(!("noteId"in e)||"string"===typeof e.noteId)&&("componentDragId"in e&&(!("componentDragId"in e)||"string"===typeof e.componentDragId)&&("toComponentDragId"in e&&(!("toComponentDragId"in e)||"string"===typeof e.toComponentDragId))))))}function p(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"update node image"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("noteId"in e&&(!("noteId"in e)||"string"===typeof e.noteId)&&("componentId"in e&&(!("componentId"in e)||"string"===typeof e.componentId)&&("newName"in e&&(!("newName"in e)||"string"===typeof e.newName)&&("newSrc"in e&&(!("newSrc"in e)||"string"===typeof e.newSrc)))))))}function g(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"update node table"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("noteId"in e&&(!("noteId"in e)||"string"===typeof e.noteId)&&("componentId"in e&&(!("componentId"in e)||"string"===typeof e.componentId)&&!(!("newValue"in e)||"newValue"in e&&!function(e){return"object"===typeof e&&!(!("headers"in e)||"headers"in e&&!Array.isArray(e.headers))&&!(!("rows"in e)||"rows"in e&&!Array.isArray(e.rows))}(e.newValue))))))}function f(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"update node table settings"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("noteId"in e&&(!("noteId"in e)||"string"===typeof e.noteId)&&("backlight"in e&&(!("backlight"in e)||"boolean"===typeof e.backlight)&&("desc"in e&&(!("desc"in e)||"string"===typeof e.desc)&&("viewButtons"in e&&(!("viewButtons"in e)||"boolean"===typeof e.viewButtons)&&("aligin"in e&&(!("aligin"in e)||"string"===typeof e.aligin))))))))}function y(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"update node link"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("noteId"in e&&(!("noteId"in e)||"string"===typeof e.noteId)&&("componentId"in e&&(!("componentId"in e)||"string"===typeof e.componentId)&&("target"in e&&(!("target"in e)||"string"===typeof e.target)&&("value"in e&&(!("value"in e)||"string"===typeof e.value)))))))}function m(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"get node by id"===e.type)&&(!(!("args"in e)||"args"in e&&!Array.isArray(e.args))&&(!(e.args.length<2)&&(!!r(e.args[0])&&"string"===typeof e.args[1]))))}function w(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"update Note component link settings"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("noteId"in e&&(!("noteId"in e)||"string"===typeof e.noteId)&&("componentId"in e&&(!("componentId"in e)||"string"===typeof e.componentId)&&("isLabel"in e&&(!("isLabel"in e)||"boolean"===typeof e.isLabel)&&("isBg"in e&&(!("isBg"in e)||"boolean"===typeof e.isBg)&&("labelVal"in e&&(!("labelVal"in e)||"string"===typeof e.labelVal))))))))}function h(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"update note component image settings"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("noteId"in e&&(!("noteId"in e)||"string"===typeof e.noteId)&&("componentId"in e&&(!("componentId"in e)||"string"===typeof e.componentId)&&("imageDesc"in e&&(!("imageDesc"in e)||"string"===typeof e.imageDesc)&&("isDescHidden"in e&&(!("isDescHidden"in e)||"boolean"===typeof e.isDescHidden)))))))}function b(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"update note component text settings"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("noteId"in e&&(!("noteId"in e)||"string"===typeof e.noteId)&&("componentId"in e&&(!("componentId"in e)||"string"===typeof e.componentId)&&("textBackground"in e&&(!("textBackground"in e)||"boolean"===typeof e.textBackground)&&("textFormat"in e&&(!("textFormat"in e)||"boolean"===typeof e.textFormat)&&("fontValue"in e&&(!("fontValue"in e)||"string"===typeof e.fontValue)&&("lineBreak"in e&&(!("lineBreak"in e)||"boolean"===typeof e.lineBreak)))))))))}function v(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"update note component list settings"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("noteId"in e&&(!("noteId"in e)||"string"===typeof e.noteId)&&("componentId"in e&&(!("componentId"in e)||"string"===typeof e.componentId)&&("listBg"in e&&(!("listBg"in e)||"boolean"===typeof e.listBg)&&("isNumeric"in e&&(!("isNumeric"in e)||"boolean"===typeof e.isNumeric)&&("aligin"in e&&(!("aligin"in e)||"string"===typeof e.aligin))))))))}function I(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"update note component header settings"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("noteId"in e&&(!("noteId"in e)||"string"===typeof e.noteId)&&("componentId"in e&&(!("componentId"in e)||"string"===typeof e.componentId)&&("textAligin"in e&&(!("textAligin"in e)||"string"===typeof e.textAligin)&&("headerSize"in e&&(!("headerSize"in e)||"string"===typeof e.headerSize)))))))}function k(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"update note component code settings"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("noteId"in e&&(!("noteId"in e)||"string"===typeof e.noteId)&&("codeTheme"in e&&(!("codeTheme"in e)||"string"===typeof e.codeTheme)&&("codeLanguage"in e&&(!("codeLanguage"in e)||"string"===typeof e.codeLanguage)&&("isExpand"in e&&(!("isExpand"in e)||"boolean"===typeof e.isExpand)&&("expandDesc"in e&&(!("expandDesc"in e)||"string"===typeof e.expandDesc))))))))}function F(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"update node completed"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("noteId"in e&&(!("noteId"in e)||"string"===typeof e.noteId)&&("newValue"in e&&(!("newValue"in e)||"boolean"===typeof e.newValue)))))}function N(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"update node name"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("target_id"in e&&(!("target_id"in e)||"string"===typeof e.target_id)&&("newName"in e&&(!("newName"in e)||"string"===typeof e.newName)))))}function D(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"add node to"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("insertToId"in e&&(!("insertToId"in e)||"string"===typeof e.insertToId)&&("newNode"in e&&!("newNode"in e&&!n(e.newNode)&&!r(e.newNode)&&!a(e.newNode))))))}function B(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"node move to"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("muvedNodeID"in e&&(!("muvedNodeID"in e)||"string"===typeof e.muvedNodeID)&&("muveToID"in e&&(!("muveToID"in e)||"string"===typeof e.muveToID)))))}function x(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"note delete tag"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("targetNoteID"in e&&(!("targetNoteID"in e)||"string"===typeof e.targetNoteID)&&!(!("tag"in e)||"tag"in e&&!function(e){return"object"===typeof e&&"tag_name"in e&&(!("tag_name"in e)||"string"===typeof e.tag_name)&&"color"in e&&(!("color"in e)||"string"===typeof e.color)}(e.tag)))))}function G(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"note add tag"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("targetNoteID"in e&&(!("targetNoteID"in e)||"string"===typeof e.targetNoteID)&&!(!("tag"in e)||"tag"in e&&"string"!==typeof e.tag&&!Array.isArray(e.tag)))))}function j(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"project delete tag"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("tagName"in e&&(!("tagName"in e)||"string"===typeof e.tagName)&&("tagData"in e&&(!("tagData"in e)||"object"===typeof e.tagData)))))}function E(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"get parent node"===e.type)&&(!(!("args"in e)||"args"in e&&!Array.isArray(e.args))&&(!(e.args.length<2)&&(!!r(e.args[0])&&"string"===typeof e.args[1]))))}function T(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"project edite tag"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("tagData"in e&&(!("tagData"in e)||"object"===typeof e.tagData)&&("oldTagName"in e&&(!("oldTagName"in e)||"string"===typeof e.oldTagName)&&("newTagName"in e&&(!("newTagName"in e)||"string"===typeof e.newTagName)&&("newTagColor"in e&&(!("newTagColor"in e)||"string"===typeof e.newTagColor)))))))}function _(e){return"object"===typeof e&&("type"in e&&(!("type"in e)||"add new component to note"===e.type)&&(!(!("rootFolder"in e)||"rootFolder"in e&&!r(e.rootFolder))&&("noteId"in e&&(!("noteId"in e)||"string"===typeof e.noteId)&&("componentType"in e&&(!("componentType"in e)||"string"===typeof e.componentType)&&!(!("savedIdGenerator"in e)||"savedIdGenerator"in e&&!Array.isArray(e.savedIdGenerator))))))}o.d(t,{Dt:()=>D,Fi:()=>k,GG:()=>n,Kq:()=>N,OH:()=>F,OU:()=>p,Ow:()=>x,PC:()=>s,Pg:()=>w,Pj:()=>h,Rm:()=>d,XW:()=>i,ZL:()=>v,eg:()=>r,f$:()=>u,fv:()=>b,g4:()=>G,jh:()=>a,kV:()=>m,l4:()=>I,lI:()=>c,mT:()=>E,nL:()=>f,p8:()=>y,qJ:()=>T,sg:()=>l,ss:()=>_,u3:()=>B,uQ:()=>j,wV:()=>g})},4189:(e,t,o)=>{o.d(t,{H4:()=>n,kd:()=>r,sN:()=>d,uC:()=>a,xB:()=>i});const n="app_note_master_db_data",r=3,a="0";function i(e){console.warn(e)}function d(e){}},2963:(e,t,o)=>{o.d(t,{OI:()=>i,fK:()=>d,kq:()=>r,qH:()=>a});var n=o(8965);function r(){(0,n.I)()?self.postMessage("worker generate event: appIndexedDBTreeUpdate"):window.dispatchEvent(new CustomEvent("appIndexedDBTreeUpdate"))}function a(){(0,n.I)()?self.postMessage("worker generate event: appIndexedDBTagsUpdate"):window.dispatchEvent(new CustomEvent("appIndexedDBTagsUpdate"))}function i(){(0,n.I)()?self.postMessage("worker generate event: appIndexedDBImagesUpdate"):window.dispatchEvent(new CustomEvent("appIndexedDBImagesUpdate"))}function d(){(0,n.I)()?self.postMessage("worker generate event: appIndexedDBTablesUpdate"):window.dispatchEvent(new CustomEvent("appIndexedDBTablesUpdate"))}},4195:(e,t,o)=>{o.d(t,{J:()=>i});var n=o(4189),r=o(1020),a=o(2963);async function i(e){let{onComplete:t=n.sN,onError:o=n.xB,callback:i,value:d}=e;const s=(await(0,r.I)()).transaction("data_tree","readwrite");return s.onerror=o,s.oncomplete=t,s.store.put(d,n.uC),await s.done,i&&i(d),(0,a.kq)(),d}},5939:(e,t,o)=>{o.d(t,{N:()=>i,O:()=>d});var n=o(4189),r=o(1020),a=o(2963);async function i(e){let{onComplete:t=n.sN,onError:o=n.xB,callback:i,value:d}=e;const s=(await(0,r.I)()).transaction("global_tags","readwrite");return s.onerror=o,s.oncomplete=t,s.store.put(d,n.uC),await s.done,i&&i(d),(0,a.qH)(),d}async function d(){let{onComplete:e=n.sN,onError:t=n.xB,callback:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=(await(0,r.I)()).transaction("global_tags","readonly");a.onerror=t,a.oncomplete=e;let i=await a.store.get(n.uC);return await a.done,o&&o(i),i}},2707:(e,t,o)=>{o.d(t,{SY:()=>i,lj:()=>d});var n=o(4189),r=o(2963),a=o(1020);async function i(e){let{onComplete:t=n.sN,onError:o=n.xB,callback:i,key:d}=e;if(!d)throw new Error("the key is required");const s=(await(0,a.I)()).transaction("data_images","readwrite");if(s.onerror=o,s.oncomplete=t,Array.isArray(d))for await(let n of d)s.store.delete(n);else await s.store.delete(d);return await s.done,i&&i(!0),(0,r.OI)(),!0}async function d(e){let{onComplete:t=n.sN,onError:o=n.xB,callback:i,value:d,key:s}=e;const l=(await(0,a.I)()).transaction("data_images","readwrite");l.onerror=o,l.oncomplete=t;return await l.store.getKey(s)&&await l.store.delete(s),await l.store.add(d),await l.done,i&&i(d),(0,r.OI)(),d}},1020:(e,t,o)=>{o.d(t,{I:()=>x});const n=(e,t)=>t.some((t=>e instanceof t));let r,a;const i=new WeakMap,d=new WeakMap,s=new WeakMap;let l={get(e,t,o){if(e instanceof IDBTransaction){if("done"===t)return i.get(e);if("store"===t)return o.objectStoreNames[1]?void 0:o.objectStore(o.objectStoreNames[0])}return g(e[t])},set:(e,t,o)=>(e[t]=o,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function c(e){l=e(l)}function u(e){return(a||(a=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return e.apply(f(this),o),g(this.request)}:function(){for(var t=arguments.length,o=new Array(t),n=0;n<t;n++)o[n]=arguments[n];return g(e.apply(f(this),o))}}function p(e){return"function"===typeof e?u(e):(e instanceof IDBTransaction&&function(e){if(i.has(e))return;const t=new Promise(((t,o)=>{const n=()=>{e.removeEventListener("complete",r),e.removeEventListener("error",a),e.removeEventListener("abort",a)},r=()=>{t(),n()},a=()=>{o(e.error||new DOMException("AbortError","AbortError")),n()};e.addEventListener("complete",r),e.addEventListener("error",a),e.addEventListener("abort",a)}));i.set(e,t)}(e),n(e,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,l):e)}function g(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,o)=>{const n=()=>{e.removeEventListener("success",r),e.removeEventListener("error",a)},r=()=>{t(g(e.result)),n()},a=()=>{o(e.error),n()};e.addEventListener("success",r),e.addEventListener("error",a)}));return s.set(t,e),t}(e);if(d.has(e))return d.get(e);const t=p(e);return t!==e&&(d.set(e,t),s.set(t,e)),t}const f=e=>s.get(e);const y=["get","getKey","getAll","getAllKeys","count"],m=["put","add","delete","clear"],w=new Map;function h(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(w.get(t))return w.get(t);const o=t.replace(/FromIndex$/,""),n=t!==o,r=m.includes(o);if(!(o in(n?IDBIndex:IDBObjectStore).prototype)||!r&&!y.includes(o))return;const a=async function(e){const t=this.transaction(e,r?"readwrite":"readonly");let a=t.store;for(var i=arguments.length,d=new Array(i>1?i-1:0),s=1;s<i;s++)d[s-1]=arguments[s];return n&&(a=a.index(d.shift())),(await Promise.all([a[o](...d),r&&t.done]))[0]};return w.set(t,a),a}c((e=>({...e,get:(t,o,n)=>h(t,o)||e.get(t,o,n),has:(t,o)=>!!h(t,o)||e.has(t,o)})));const b=["continue","continuePrimaryKey","advance"],v={},I=new WeakMap,k=new WeakMap,F={get(e,t){if(!b.includes(t))return e[t];let o=v[t];return o||(o=v[t]=function(){I.set(this,k.get(this)[t](...arguments))}),o}};async function*N(){let e=this;if(e instanceof IDBCursor||(e=await e.openCursor(...arguments)),!e)return;const t=new Proxy(e,F);for(k.set(t,e),s.set(t,f(e));e;)yield t,e=await(I.get(t)||e.continue()),I.delete(t)}function D(e,t){return t===Symbol.asyncIterator&&n(e,[IDBIndex,IDBObjectStore,IDBCursor])||"iterate"===t&&n(e,[IDBIndex,IDBObjectStore])}c((e=>({...e,get:(t,o,n)=>D(t,o)?N:e.get(t,o,n),has:(t,o)=>D(t,o)||e.has(t,o)})));var B=o(4189);async function x(){const e=await function(e,t){let{blocked:o,upgrade:n,blocking:r,terminated:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=indexedDB.open(e,t),d=g(i);return n&&i.addEventListener("upgradeneeded",(e=>{n(g(i.result),e.oldVersion,e.newVersion,g(i.transaction),e)})),o&&i.addEventListener("blocked",(e=>o(e.oldVersion,e.newVersion,e))),d.then((e=>{a&&e.addEventListener("close",(()=>a())),r&&e.addEventListener("versionchange",(e=>r(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),d}(B.H4,B.kd,{upgrade(e,t,o,n,r){if(t===o){e.createObjectStore("savedData"),e.createObjectStore("db_type"),e.createObjectStore("data_tree"),e.createObjectStore("global_tags"),e.createObjectStore("data_images",{keyPath:"id"}),e.createObjectStore("data_tables",{keyPath:"id"})}else{let n=t;do{switch(n+1){case 1:e.createObjectStore("savedData"),e.createObjectStore("db_type"),e.createObjectStore("data_tree"),e.createObjectStore("global_tags");break;case 2:e.createObjectStore("data_images",{keyPath:"id"});break;case 3:e.createObjectStore("data_tables",{keyPath:"id"});break;default:throw new Error("A new version of the database has been detected, but the logic for updating the schema has not been implemented.")}n++}while(n<(null!==o&&void 0!==o?o:1))}},blocked(e,t,o){},blocking(e,t,o){},terminated(){}});return e}},7259:(e,t,o)=>{o.d(t,{UY:()=>s,jF:()=>i,mX:()=>d});var n=o(4189),r=o(2963),a=o(1020);async function i(e){let{onComplete:t=n.sN,onError:o=n.xB,callback:i,value:d,key:s}=e;const l=(await(0,a.I)()).transaction("data_tables","readwrite");l.onerror=o,l.oncomplete=t;return await l.store.getKey(s)&&await l.store.delete(s),await l.store.add(d),await l.done,i&&i(d),(0,r.fK)(),d}async function d(e){let{onComplete:t=n.sN,onError:o=n.xB,callback:r,key:i}=e;if(!i)throw new Error("key ");const d=(await(0,a.I)()).transaction("data_tables","readonly");d.onerror=o,d.oncomplete=t;let s=await d.store.get(i);return await d.done,r&&r(s),s}async function s(e){let{onComplete:t=n.sN,onError:o=n.xB,callback:i,key:d}=e;if(!d)throw new Error("the key is required");const s=(await(0,a.I)()).transaction("data_tables","readwrite");if(s.onerror=o,s.oncomplete=t,Array.isArray(d))for await(let n of d)s.store.delete(n);else await s.store.delete(d);return await s.done,i&&i(!0),(0,r.fK)(),!0}},2153:(e,t,o)=>{o.d(t,{hY:()=>r});var n=o(8954);function r(e){const t=[],o=e=>{if((0,n.eg)(e)){if(!e.children)return;for(let t of e.children)o(t)}(0,n.GG)(e)&&t.push(e)};return o(e),t}}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var a=t[n]={exports:{}};return e[n](a,a.exports,o),a.exports}o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e=o(8954),t=o(1990);var n=o(2707),r=o(4195),a=o(7259);async function i(o){let i,d,s=!1,l=new t.R(new Set(o.savedIdGenerator));const c=t=>{if(t.id===o.target_id&&"root"!==t.id)return i.children=i.children.filter((t=>{if(t.id===o.target_id){if((0,e.eg)(t)||(0,e.GG)(t)){const e=function(e){const t=new Set,o=e=>{for(let n in e)if("id"!==n){if("children"===n)for(let t of e[n])o(t);if("body"===n)for(let t of e[n])o(t)}else{if(t.has(e[n]))throw new Error("Duplicate id in tempData");t.add(e[n])}};return o(e),Array.from(t)}(t);(0,n.SY)({key:e}),(0,a.UY)({key:e}),e.map((e=>{l.deleteId(e)}))}return l.deleteId(o.target_id),d=t,!1}return!0})),s=!0,!0;if((0,e.eg)(t)&&t.children){let e=i;i=t;for(let o of t.children){if(c(o))return!0}i=e}};if(i=o.rootNode,!c(o.rootNode))throw new Error("node not found");return await(0,r.J)({value:o.rootNode}),{deletedNode:d,resultBool:s,newIdGenerator:l.getIdsArray()}}function d(t,o){const n=t=>{if(t.id===o)return t;if((0,e.eg)(t)&&t.children)for(let e of t.children){let t=n(e);if(t)return t}if((0,e.GG)(t))for(let e of t.body)if(e.id===o)return e;return null};if(t){return n(t)}return null}async function s(e,t){var o;let n={...e,children:[]},r=new Set;return t?(n=null!==(o=await l(e,n,t,r))&&void 0!==o?o:e,[n,r]):[e,r]}async function l(t,o,n,r){"root"===o.id&&!r.has(o.id)&&r.add(o.id);for(let a of t.children)if((0,e.GG)(a)&&await c(a,n)){!r.has(t.id)&&r.add(t.id);const e=structuredClone(a);o.children.push(e)}else if((0,e.eg)(a)&&a.children&&a.children.length>0){const e={...a,children:[]};let t=await l(a,e,n,r);t.children&&t.children.length>0&&(o.children.push(t),!r.has(t.id)&&r.add(t.id))}return o}async function c(e,t){let o=!1,n=!1,r=!1;if(""!==t.name?e.name.includes(t.name)&&(o=!0):o=!0,t.tags.length>0){if(t.tags.length>0&&(!e.tags||e.tags&&0===e.tags.length)&&(n=!1),t.tags.length>0&&e.tags&&e.tags.length>0){let o=[];for(let n of t.tags)e.tags.includes(n)&&o.push(n);o.length===t.tags.length&&(n=!0)}}else n=!0;if(""!==t.content)for(let i of e.body){if(i.value.includes(t.content))return!0;if("link"==i.component)return i.isLabel&&i.labelValue.includes(t.content);if("code"==i.component)return i.isExpand&&i.expandDesc.includes(t.content);if("image"==i.component)return!i.isDescHidden&&i.desc.includes(t.content);if("table"==i.component){if(i.desc&&i.desc.includes(t.content))return!0;if(""!==i.value){const e=await(0,a.mX)({key:i.value});if(e&&e.value){return JSON.stringify(e.value).includes(t.content)}}}}else r=!0;return o&&n&&r}function u(t,o){let n,r;n=t;const a=t=>{if(t.id===o){if(t.id===n.id)return;return n}if((0,e.eg)(t)){if(t.children){let e=n;n=t;for(let o of t.children){let e=a(o);if(void 0===e)return null;if(e)return e}n=e}return null}if((0,e.GG)(t)){let e=n;n=t;for(let o of t.body){let e=a(o);if(void 0===e)return null;if(e)return e}n=e}return null};return r=a(n),r}var p=o(5939);var g=o(2153);var f=o(8594);var y=o(6603);class m extends y.R{constructor(e){super("component",e),this.component=void 0,this.value=void 0,this.headerSize=void 0,this.textAligin=void 0,this.component="header",this.value="",this.headerSize="h3",this.textAligin="center",Object.setPrototypeOf(this,null)}}class w extends y.R{constructor(e){super("component",e),this.component=void 0,this.value=void 0,this.background=void 0,this.formatting=void 0,this.font=void 0,this.lineBreak=void 0,this.component="text",this.value="",this.background=!1,this.font="default",this.formatting=!0,this.lineBreak=!0,Object.setPrototypeOf(this,null)}}class h extends y.R{constructor(e){super("component",e),this.component=void 0,this.value=void 0,this.language=void 0,this.codeTheme=void 0,this.isExpand=void 0,this.expandDesc=void 0,this.component="code",this.value="",this.language="text",this.codeTheme="auto",this.isExpand=!1,this.expandDesc="",Object.setPrototypeOf(this,null)}}class b extends y.R{constructor(e){super("component",e),this.component=void 0,this.value=void 0,this.desc=void 0,this.isDescHidden=void 0,this.fileName=void 0,this.component="image",this.value="",this.desc="",this.isDescHidden=!1,this.fileName="",Object.setPrototypeOf(this,null)}}class v extends y.R{constructor(e){super("component",e),this.component=void 0,this.value=void 0,this.labelValue=void 0,this.isLabel=void 0,this.background=void 0,this.target=void 0,this.component="link",this.value="#",this.labelValue="Link",this.isLabel=!1,this.background=!1,this.target="web",Object.setPrototypeOf(this,null)}}class I extends y.R{constructor(e){super("component",e),this.component=void 0,this.value=void 0,this.component="video",this.value="",Object.setPrototypeOf(this,null)}}class k extends y.R{constructor(e){super("component",e),this.component=void 0,this.value=void 0,this.background=void 0,this.isNumeric=void 0,this.textAligin=void 0,this.component="list",this.value="",this.background=!1,this.isNumeric=!1,this.textAligin="left",Object.setPrototypeOf(this,null)}}var F=o(524);function N(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;self.postMessage({resolve:e,work_data:t})}self.onmessage=o=>{const l=o.data;l&&((0,e.XW)(l)?function(e){let{argument_names:t=[],argument_values:n=[],func_data:r=""}=e;r&&(N("Function executor: started"),function(e,t,n){try{const o=new Function(...e,n);N("Function executor: finished",o(...t))}catch(o){N("Function executor: error"),console.error(o)}}(t,n,r))}(l):((0,e.Pj)(l)||(0,e.Pg)(l)||(0,e.kV)(l)||(0,e.p8)(l)||(0,e.nL)(l)||(0,e.wV)(l)||(0,e.OU)(l)||(0,e.f$)(l)||(0,e.lI)(l)||(0,e.sg)(l)||(0,e.PC)(l)||(0,e.Rm)(l)||(0,e.fv)(l)||(0,e.ZL)(l)||(0,e.l4)(l)||(0,e.Fi)(l)||(0,e.OH)(l)||(0,e.Kq)(l)||(0,e.Dt)(l)||(0,e.u3)(l)||(0,e.Ow)(l)||(0,e.g4)(l)||(0,e.uQ)(l)||(0,e.mT)(l)||(0,e.qJ)(l)||(0,e.ss)(l))&&async function(l){try{let o;switch(N("".concat(l.type,": started")),console.info("dedicatedWorker.taskRuner: type '".concat(l.type,"'")),l.type){case"update note component image settings":o=await async function(t){let o=d(t.rootFolder,t.noteId),n=!1;if(o&&(0,e.GG)(o))for(let e of o.body)if(e.id===t.componentId&&"image"===e.component){e.desc=t.imageDesc,e.isDescHidden=t.isDescHidden,o.lastEditTime=Date.now(),n=!0,await(0,r.J)({value:t.rootFolder});break}return{targetNote:o,resultBool:n}}(l);break;case"clone filtred tree":o=await s(...l.args);break;case"delete by id":o=await i(l);break;case"delete component in note":o=await async function(o){let i=new t.R(new Set(o.savedIdGenerator)),s=!1,l=d(o.rootFolder,o.noteID);return l&&(0,e.GG)(l)&&(l.body=l.body.filter((e=>e.id!==o.componentID||(i.deleteId(o.componentID),"image"==e.component&&((0,n.SY)({key:e.id}),e.value=""),"table"==e.component&&((0,a.UY)({key:e.id}),e.value=""),!1))),l.lastEditTime=Date.now(),s=!0,await(0,r.J)({value:o.rootFolder})),{targetNote:l,resultBool:s,newIdGenerator:i.getIdsArray()}}(l);break;case"get node by id":o=d(...l.args);break;case"update Note component link settings":o=await async function(t){let o=d(t.rootFolder,t.noteId),n=!1;if(o&&(0,e.GG)(o))for(let e of o.body)if(e.id===t.componentId&&"link"===e.component){e.background=t.isBg,e.isLabel=t.isLabel,e.labelValue=t.labelVal,o.lastEditTime=Date.now(),n=!0,await(0,r.J)({value:t.rootFolder});break}return{targetNote:o,resultBool:n}}(l);break;case"update node image":o=await async function(t){let o=d(t.rootFolder,t.noteId),a=!1;if(o&&(0,e.GG)(o)){for(let e of o.body)if(e.id===t.componentId){"image"===e.component&&(e.fileName=t.newName,""===t.newSrc?(e.value="",e.desc=""):e.value=e.id,(0,n.lj)({value:{id:t.componentId,src:t.newSrc},key:e.id}));break}o.lastEditTime=Date.now(),a=!0,await(0,r.J)({value:t.rootFolder})}return{targetNote:o,resultBool:a}}(l);break;case"update node link":o=await async function(t){let o=d(t.rootFolder,t.noteId),n=!1;if(o&&(0,e.GG)(o)){for(let e of o.body)if(e.id===t.componentId){"link"===e.component&&(e.target=t.target,e.value=t.value);break}o.lastEditTime=Date.now(),n=!0,await(0,r.J)({value:t.rootFolder})}return{targetNote:o,resultBool:n}}(l);break;case"update node table":o=await async function(t){let o=d(t.rootFolder,t.noteId),n=!1;if(o&&(0,e.GG)(o)){for(let e of o.body)if(e.id===t.componentId){"table"===e.component&&(""===t.newValue?(e.value="",(0,a.UY)({key:t.componentId})):(e.value=t.componentId,(0,a.jF)({value:{id:t.componentId,value:t.newValue},key:t.componentId})));break}o.lastEditTime=Date.now(),n=!0,await(0,r.J)({value:t.rootFolder})}return{targetNote:o,resultBool:n}}(l);break;case"update node table settings":o=await async function(t){let o=d(t.rootFolder,t.noteId),n=!1;if(o&&(0,e.GG)(o))for(let e of o.body)if(e.id===t.componentId&&"table"===e.component){e.backlight=t.backlight,e.desc=t.desc,e.viewButtons=t.viewButtons,e.aligin=t.aligin,o.lastEditTime=Date.now(),n=!0,await(0,r.J)({value:t.rootFolder});break}return{targetNote:o,resultBool:n}}(l);break;case"update node value":o=await async function(t){let o=d(t.rootFolder,t.noteId),n=!1;if(o&&(0,e.GG)(o)){for(let e of o.body)if(e.id===t.componentId){e.value=t.newValue;break}o.lastEditTime=Date.now(),n=!0,await(0,r.J)({value:t.rootFolder})}return{targetNote:o,resultBool:n}}(l);break;case"update note components order":o=await async function(t){let o=d(t.rootFolder,t.noteId),n=!1;if(o&&(0,e.GG)(o)){let e=null,a=null;for(let n=0;n<o.body.length&&(!e||!a);n++)o.body[n].id!==t.componentDragId?o.body[n].id!==t.toComponentDragId||(a=n):e=n;null!==e&&null!==a&&(o.body=function(e,t,o){let n=[...e];const r=n[t];if(t<o)for(let a=t;a<o;a++)n[a]=n[a+1];else for(let a=t;a>o;a--)n[a]=n[a-1];return n[o]=r,n}(o.body,e,a)),o.lastEditTime=Date.now(),n=!0,await(0,r.J)({value:t.rootFolder})}return{targetNote:o,resultBool:n}}(l);break;case"update note component text settings":o=await async function(t){let o=d(t.rootFolder,t.noteId),n=!1;if(o&&(0,e.GG)(o))for(let e of o.body)if(e.id===t.componentId&&"text"===e.component){e.background=t.textBackground,e.font=t.fontValue,e.formatting=t.textFormat,e.lineBreak=t.lineBreak,o.lastEditTime=Date.now(),n=!0,await(0,r.J)({value:t.rootFolder});break}return{targetNote:o,resultBool:n}}(l);break;case"update note component list settings":o=await async function(t){let o=d(t.rootFolder,t.noteId),n=!1;if(o&&(0,e.GG)(o))for(let e of o.body)if(e.id===t.componentId&&"list"===e.component){e.background=t.listBg,e.isNumeric=t.isNumeric,e.textAligin=t.aligin,o.lastEditTime=Date.now(),n=!0,await(0,r.J)({value:t.rootFolder});break}return{targetNote:o,resultBool:n}}(l);break;case"update note component header settings":o=await async function(t){let o=d(t.rootFolder,t.noteId),n=!1;if(o&&(0,e.GG)(o))for(let e of o.body)if(e.id===t.componentId&&"header"===e.component){e.headerSize=t.headerSize,e.textAligin=t.textAligin,o.lastEditTime=Date.now(),n=!0,await(0,r.J)({value:t.rootFolder});break}return{targetNote:o,resultBool:n}}(l);break;case"update note component code settings":o=await async function(t){let o=d(t.rootFolder,t.noteId),n=!1;if(o&&(0,e.GG)(o))for(let e of o.body)if(e.id===t.componentId&&"code"===e.component){e.codeTheme=t.codeTheme,e.language=t.codeLanguage,e.isExpand=t.isExpand,e.expandDesc=t.expandDesc,o.lastEditTime=Date.now(),n=!0,await(0,r.J)({value:t.rootFolder});break}return{targetNote:o,resultBool:n}}(l);break;case"update node completed":o=await async function(t){let o=d(t.rootFolder,t.noteId),n=!1;return o&&(0,e.GG)(o)&&(o.completed!==t.newValue&&(o.completed=t.newValue,n=!0,o.lastEditTime=Date.now(),await(0,r.J)({value:t.rootFolder})),n=!0),{targetNote:o,resultBool:n}}(l);break;case"update node name":o=await async function(t){let o=d(t.rootFolder,t.target_id),n=!1;return(o&&(0,e.eg)(o)||(0,e.GG)(o))&&(o.name=t.newName,n=!0,(0,e.GG)(o)&&(o.lastEditTime=Date.now()),await(0,r.J)({value:t.rootFolder})),{targetNode:o,resultBool:n}}(l);break;case"add node to":o=await async function(t){let o=d(t.rootFolder,t.insertToId),n=!1;return o?(0,e.eg)(o)&&((0,e.eg)(t.newNode)||(0,e.GG)(t.newNode))?(o.children||(o.children=[]),o.children.push(t.newNode),n=!0,await(0,r.J)({value:t.rootFolder}),{newNode:t.newNode,resultBool:n}):(0,e.GG)(o)&&(0,e.jh)(t.newNode)?(o.body.push(t.newNode),n=!0,await(0,r.J)({value:t.rootFolder}),{newNode:t.newNode,resultBool:n}):{newNode:null,resultBool:n}:{newNode:null,resultBool:n}}(l);break;case"node move to":o=await async function(t){let o=d(t.rootFolder,t.muvedNodeID),n=o&&u(t.rootFolder,o.id),a=d(t.rootFolder,t.muveToID),i=!1;return o&&n&&a?"root"===o.id||d(o,a.id)||n.id===a.id||a.id===t.muvedNodeID?{muvedNode:o,resultBool:i}:((0,e.eg)(n)&&(n.children=n.children.filter((e=>e.id!==o.id))),(0,e.eg)(a)&&((0,e.eg)(o)||(0,e.GG)(o))?(a.children||(a.children=[]),a.children.push(o),i=!0,await(0,r.J)({value:t.rootFolder}),{muvedNode:o,resultBool:i}):{muvedNode:null,resultBool:i}):{muvedNode:null,resultBool:i}}(l);break;case"note delete tag":o=await async function(t){let o=d(t.rootFolder,t.targetNoteID),n=!1;return o&&(0,e.GG)(o)&&"tags"in o?(o.tags=o.tags.filter((e=>e!==t.tag.tag_name)),o.lastEditTime=Date.now(),n=!0,await(0,r.J)({value:t.rootFolder}),{targetNote:o,resultBool:n}):{targetNote:null,resultBool:n}}(l);break;case"note add tag":o=await async function(t){let o=d(t.rootFolder,t.targetNoteID);const n=await(0,p.O)();let a=[],i=!1;if(!n)return{targetNote:null,resultBool:i};if(Array.isArray(t.tag)&&t.tag.length>0){for(let e of t.tag)if(!(e in n))return{targetNote:null,resultBool:i};a=[...t.tag]}if("string"===typeof t.tag&&""!==t.tag){if(!(t.tag in n))return{targetNote:null,resultBool:i};a.push(t.tag)}return o&&(0,e.GG)(o)?("tags"in o||(o.tags=[]),o.tags=o.tags.concat(a),o.lastEditTime=Date.now(),i=!0,await(0,r.J)({value:t.rootFolder}),{targetNote:o,resultBool:i}):{targetNote:null,resultBool:i}}(l);break;case"project delete tag":o=await async function(e){let t=!1;if(e.tagName in e.tagData){delete e.tagData[e.tagName];const o=(0,g.hY)(e.rootFolder);for(let t of o)t.tags&&(t.tags=t.tags.filter((t=>t!==e.tagName)));t=!0,await(0,p.N)({value:e.tagData}),await(0,r.J)({value:e.rootFolder})}return{tagName:e.tagName,resultBool:t}}(l);break;case"get parent node":o=await u(...l.args);break;case"project edite tag":o=await async function(e){let t=!1;if(e.oldTagName!==e.newTagName){if(!(e.newTagName in e.tagData)){delete e.tagData[e.oldTagName],e.tagData[e.newTagName]=new f.$(e.newTagName,e.newTagColor);const o=(0,g.hY)(e.rootFolder);for(let t of o){if(!t.tags)continue;const o=t.tags.indexOf(e.oldTagName);-1!==o&&(t.tags[o]=e.newTagName)}t=!0,await(0,r.J)({value:e.rootFolder})}}else t=!0,e.tagData[e.oldTagName].color=e.newTagColor;return await(0,p.N)({value:e.tagData}),{newTagName:e.newTagName,resultBool:t}}(l);break;case"add new component to note":o=await async function(o){let n=!1,a=new t.R(new Set(o.savedIdGenerator)),i=d(o.rootFolder,o.noteId);if(i&&(0,e.GG)(i)){let e;switch(o.componentType){case"header":e=new m(a);break;case"text":e=new w(a);break;case"code":e=new h(a);break;case"image":e=new b(a);break;case"link":e=new v(a);break;case"video":e=new I(a);break;case"list":e=new k(a);break;case"table":e=new F.m7(a);break;default:e=void 0}void 0!==e&&(i.lastEditTime=Date.now(),n=!0,i.body.push(e),await(0,r.J)({value:o.rootFolder}))}return{updatedNote:i,resultBool:n,newIdGenerator:a.getIdsArray()}}(l);break;default:throw console.error("dedicatedWorker.taskRuner: task type error, task '".concat(l.type,"' unknown")),new Error}N("".concat(l.type,": finished"),o)}catch(o){N("".concat(l.type,": error")),console.error(o)}}(l))}})()})();
//# sourceMappingURL=Dedicated Worker.f78dad5f.chunk.js.map